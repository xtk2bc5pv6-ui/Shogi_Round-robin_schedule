<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>将棋 3人総当たり戦 星取表</title>
    <style>
        :root {
            --bg-color: #121212; /* 背景色：ほぼ黒 */
            --card-bg: #1e1e1e;  /* カード背景：少し明るい黒 */
            --neon-green: #39ff14; /* 蛍光グリーン */
            --neon-blue: #00ffff;  /* 蛍光シアン（負け色） */
            --neon-pink: #ff00ff;  /* 蛍光ピンク（勝ち色） */
            --text-color: #e0e0e0; /* 通常文字色 */
        }
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--neon-green); /* 基本文字色を蛍光グリーンに */
            text-shadow: 0 0 5px rgba(57, 255, 20, 0.5); /* 文字を少し光らせる */
        }
        h1 {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: var(--neon-green);
            text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green); /* ネオン効果強化 */
            letter-spacing: 2px;
        }
        .card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            /* ネオン風の枠線と発光 */
            border: 1px solid var(--neon-green);
            box-shadow: 0 0 10px rgba(57, 255, 20, 0.2), inset 0 0 5px rgba(57, 255, 20, 0.1);
            margin-bottom: 25px;
        }
        h2 {
            font-size: 1.2rem;
            border-bottom: 2px solid var(--neon-green);
            padding-bottom: 10px;
            margin-top: 0;
            color: var(--neon-blue);
            text-shadow: 0 0 5px var(--neon-blue);
        }
        /* 入力エリア */
        .player-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        input[type="text"], select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--neon-green);
            border-radius: 4px;
            background-color: #000;
            color: var(--neon-green);
            font-size: 1rem;
            box-shadow: inset 0 0 5px rgba(57, 255, 20, 0.3);
        }
        input[type="text"]:focus, select:focus {
            outline: none;
            box-shadow: 0 0 10px var(--neon-green);
        }
        
        .match-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .match-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #000;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #333;
        }
        .match-row span {
             font-weight: bold;
             color: var(--text-color);
        }
        
        /* 星取表 */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border: 1px solid var(--neon-green);
        }
        th, td {
            border: 1px solid var(--neon-green);
            padding: 12px 8px;
            text-align: center;
        }
        th {
            background-color: #000;
            color: var(--neon-blue);
            font-weight: bold;
            text-shadow: 0 0 5px var(--neon-blue);
        }
        td {
            color: var(--text-color);
        }
        .rank-1 { 
            background-color: rgba(57, 255, 20, 0.1); /* 1位を少し光らせる */
            box-shadow: inset 0 0 10px rgba(57, 255, 20, 0.2);
        }
        
        /* 勝敗の色 */
        .win { color: var(--neon-pink); font-weight: bold; text-shadow: 0 0 8px var(--neon-pink); }
        .loss { color: var(--neon-blue); text-shadow: 0 0 8px var(--neon-blue); }
        
        button.reset-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: transparent;
            color: var(--neon-green);
            border: 2px solid var(--neon-green);
            border-radius: 4px;
            cursor: pointer;
            margin-top: 30px;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            text-shadow: 0 0 5px var(--neon-green);
            box-shadow: 0 0 5px var(--neon-green);
        }
        button.reset-btn:hover {
            background-color: var(--neon-green);
            color: #000;
            box-shadow: 0 0 20px var(--neon-green);
        }
    </style>
</head>
<body>

    <h1>将棋電脳戦 総当たり表</h1>

    <div class="card">
        <h2>順位・星取表</h2>
        <table id="resultTable">
            <thead>
                <tr>
                    <th>順位</th>
                    <th>氏名</th>
                    <th>勝</th>
                    <th>対戦結果</th>
                </tr>
            </thead>
            <tbody id="rankingBody">
                </tbody>
        </table>
    </div>

    <div class="card">
        <h2>対局者名エントリー</h2>
        <div class="player-inputs">
            <input type="text" id="p1Name" value="Aさん" oninput="updateNames()">
            <input type="text" id="p2Name" value="Bさん" oninput="updateNames()">
            <input type="text" id="p3Name" value="Cさん" oninput="updateNames()">
        </div>
    </div>

    <div class="card">
        <h2>対局結果入力システム</h2>
        <div class="match-list">
            <div class="match-row">
                <span id="labelMatch1">A vs B</span>
                <select id="match1" onchange="calculate()">
                    <option value="none">未対局</option>
                    <option value="p1">A 勝ち</option>
                    <option value="p2">B 勝ち</option>
                </select>
            </div>
            <div class="match-row">
                <span id="labelMatch2">B vs C</span>
                <select id="match2" onchange="calculate()">
                    <option value="none">未対局</option>
                    <option value="p2">B 勝ち</option>
                    <option value="p3">C 勝ち</option>
                </select>
            </div>
            <div class="match-row">
                <span id="labelMatch3">C vs A</span>
                <select id="match3" onchange="calculate()">
                    <option value="none">未対局</option>
                    <option value="p3">C 勝ち</option>
                    <option value="p1">A 勝ち</option>
                </select>
            </div>
        </div>
    </div>

    <button class="reset-btn" onclick="resetAll()">システムリセット</button>

    <script>
        // 初期データ
        let players = [
            { id: 'p1', name: 'Aさん', wins: 0, results: {} },
            { id: 'p2', name: 'Bさん', wins: 0, results: {} },
            { id: 'p3', name: 'Cさん', wins: 0, results: {} }
        ];

        // 名前更新
        function updateNames() {
            players[0].name = document.getElementById('p1Name').value || 'Aさん';
            players[1].name = document.getElementById('p2Name').value || 'Bさん';
            players[2].name = document.getElementById('p3Name').value || 'Cさん';
            
            updateLabels();
            calculate(); // 表の再描画
        }

        // ラベル（〇〇 vs 〇〇）の更新
        function updateLabels() {
            const matchOptions = [
                { sel: document.getElementById('match1'), pA: 0, pB: 1 },
                { sel: document.getElementById('match2'), pA: 1, pB: 2 },
                { sel: document.getElementById('match3'), pA: 2, pB: 0 }
            ];

            document.getElementById('labelMatch1').textContent = `${players[0].name} vs ${players[1].name}`;
            document.getElementById('labelMatch2').textContent = `${players[1].name} vs ${players[2].name}`;
            document.getElementById('labelMatch3').textContent = `${players[2].name} vs ${players[0].name}`;

            // セレクトボックスの選択肢名も更新
            matchOptions.forEach(m => {
                m.sel.options[1].text = `${players[m.pA].name} 勝ち`;
                m.sel.options[2].text = `${players[m.pB].name} 勝ち`;
            });
        }

        // 計算と表示のメイン処理
        function calculate() {
            // スコアリセット
            players.forEach(p => {
                p.wins = 0;
                p.results = {}; // 対戦相手ID: 結果('o', 'x', '-')
            });

            // 対局結果の取得
            const m1 = document.getElementById('match1').value; // p1 vs p2
            const m2 = document.getElementById('match2').value; // p2 vs p3
            const m3 = document.getElementById('match3').value; // p3 vs p1

            // 勝敗判定ロジック
            const processMatch = (val, pA_idx, pB_idx) => {
                const pA = players[pA_idx];
                const pB = players[pB_idx];

                if (val === pA.id) {
                    pA.wins++;
                    pA.results[pB.id] = '○';
                    pB.results[pA.id] = '●';
                } else if (val === pB.id) {
                    pB.wins++;
                    pB.results[pA.id] = '●';
                    pA.results[pB.id] = '○';
                } else {
                    pA.results[pB.id] = '-';
                    pB.results[pA.id] = '-';
                }
            };

            processMatch(m1, 0, 1);
            processMatch(m2, 1, 2);
            processMatch(m3, 2, 0);

            // 並べ替え用の配列をコピー
            let ranking = JSON.parse(JSON.stringify(players));

            // ソート：勝ち数が多い順
            ranking.sort((a, b) => b.wins - a.wins);

            // HTML生成
            const tbody = document.getElementById('rankingBody');
            tbody.innerHTML = '';

            ranking.forEach((p, index) => {
                const tr = document.createElement('tr');
                if (index === 0 && p.wins > 0) tr.classList.add('rank-1'); // 1勝以上で1位を強調

                let details = [];
                ranking.forEach(opponent => {
                    if (p.id !== opponent.id) {
                        const res = p.results[opponent.id];
                        let colorClass = res === '○' ? 'win' : (res === '●' ? 'loss' : '');
                        if (res !== '-') {
                            details.push(`<span class="${colorClass}">${res}</span> ${opponent.name}`);
                        }
                    }
                });

                tr.innerHTML = `
                    <td style="font-weight:bold; color:var(--neon-blue)">${index + 1}位</td>
                    <td style="font-weight:bold; font-size:1.1rem;">${p.name}</td>
                    <td>${p.wins}勝</td>
                    <td style="font-size:0.9rem;">${details.join('<br>') || '-'}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function resetAll() {
            document.getElementById('match1').value = "none";
            document.getElementById('match2').value = "none";
            document.getElementById('match3').value = "none";
            calculate();
        }

        // 初回実行
        updateNames();
    </script>
</body>
</html>
